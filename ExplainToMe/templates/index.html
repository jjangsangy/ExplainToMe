{% extends "base.html" %}

{% block title %}
{% if url %}
    {% if meta['title'] %}
        {{ meta['title'] }}
    {% else %}
        ExplainToMe - Text Summarization for Humans
    {% endif %}
{% endif %}
{% endblock %}

{% block content %}
<div class="form">
    <form class="form-inline" action="/summary" method="post">
        <div class="form-group">
            {{ form.url() }}
            {{ form.csrf_token }}
        </div>
        <div class="form-group">
            {{ form.max_sent() }}
        </div>
            <button type="submit" class="btn btn-success">
                Summarize
            </button>
    </form>
</div>
{% endblock %}

{% block summary %}
{% if url %}

<!-- Right Block -->
<div class="col-lg-5 col-lg-offset-1 col-sm-push-6 col-sm-6">
    <hr class="section-heading-spacer">
    <div class="clearfix"></div>
    <h3 class="section-heading">

    <!-- Heading -->
    <a href="{{ url }}">
        {% if meta['title'] %} {{ meta['title'] }} {% else %} Summary {% endif %}
    </a>
    </h3>

    <!-- Description -->
    <h3>Description</h3>
    {% if meta['meta']['description'] %}
        <strong><p>{{ meta['meta']['description'] }}</p></strong>
    {% endif %}

    <!-- Summary Content -->
    <h3>{{ max_sent }} Sentence Summary</h3>
    {% for line in summary %}
        <p class="lead">{{ line }}<p>
    {% endfor %}

</div>

<!-- Left Block -->
<div class="col-lg-5 col-sm-pull-6 col-sm-6">
    <hr class="section-heading-spacer">
    <div class="clearfix"></div>

    <!-- Article Image -->
    {% if meta['image']['url'] %}
        <h3>Article Image</h3>
        <img src="{{ meta['image']['url'] }}" class="img-responsive">
    {% endif %}


    <h3>Breadcrumbs</h3>
    <!-- Authors -->
    <div class="row">
    {% if meta['authors'] %}
        <span class="label label-primary">By</span>
        <i class="fa fa-user"></i>
        {% for a in meta['authors'] %}
            {{ a }},
        {% endfor %}
    {% endif %}
    </div>

    <!-- Published Date -->
    <div class="row">
    {% if meta['publish_date'] %}
        <span class="label label-primary">Date</span>
        <span class="published">
            <i class="fa fa-calendar"></i>
            <time datetime="{{ meta['publish_date'] }}">{{ meta['publish_date'] | datetimefilter }}</time>
        </span>
    {% endif %}
    </div>

    <!-- Tags -->
    <div class="row">
    {% if meta['tags'] %}
        <span class="label label-info">Tags</span>
        <i class="fa fa-tag"></i>
            {% for tag in meta['tags'] %}<span class="label label-success">{{ tag }}</span>{% endfor %}
    {% endif %}
    </div>

    <!-- OpenGraph -->
    <div class="row">
    {% if meta['opengraph'] %}
    <h3>Metadata</h3>
        <ul class="list-group">
            {% for key, value in meta['opengraph'].iteritems() %}
                <li class="list-group-item">
                    <h5 class="list-group-item-heading">{{ key }}</h5>
                    <p class="list-group-item-text">{{ value }}</p>
                </li>
            {% endfor %}
        </ul>
    </div>
{% endif %}
</div> <!-- /Left Block -->

{% endif %}
{% endblock %}
